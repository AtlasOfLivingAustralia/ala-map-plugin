<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: controls/TwoStepSelector.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: controls/TwoStepSelector.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * Custom Leaflet control which will display two select boxes. Selecing an item in the first box will populate the second.
 * Selecting an item in the second box will update the map.
 *
 * &lt;p/>
 * &lt;b>Options:&lt;/b>
 * &lt;ul>
 *     &lt;li>&lt;pre>id&lt;/pre> - Unique id for the control&lt;/li>
 *     &lt;li>&lt;pre>position&lt;/pre> - The location on the map (using leaflet's standard control positions). Default: topleft&lt;/li>
 *     &lt;li>&lt;pre>title&lt;/pre> - The tooltip for the button. Default: 'Select...'&lt;/li>
 *     &lt;li>&lt;pre>firstStepItems&lt;/pre> - array of items (key/value) to be displayed in the first selector (alternatively, use firstStepItemLookup)&lt;/li>
 *     &lt;li>&lt;pre>firstStepItemLookup&lt;/pre> - Function callback to retrieve the list of items to be displayed in the first selector&lt;/li>
 *     &lt;li>&lt;pre>firstStepTitle&lt;/pre> - Tooltip for the first select box&lt;/li>
 *     &lt;li>&lt;pre>firstStepPlaceholder&lt;/pre> - Placeholder text for the first (null) item in the first selector. Default: 'Select one...'&lt;/li>
 *     &lt;li>&lt;pre>secondStepItemLookup&lt;/pre> - Function callback to populate the second selector when the first selector is set&lt;/li>
 *     &lt;li>&lt;pre>secondStepPlaceholder&lt;/pre> - Placeholder text for the first (null) item in the second selector. Default: 'Select one...'&lt;/li>
 *     &lt;li>&lt;pre>secondStepTitle&lt;/pre> - Tooltip for the second select box&lt;/li>
 *     &lt;li>&lt;pre>selectionAction&lt;/pre> - Function callback to invoke when the second selector is set&lt;/li>
 *     &lt;li>&lt;pre>firstStepValue&lt;/pre> - The initial value for the first selector&lt;/li>
 *     &lt;li>&lt;pre>iconClass&lt;/pre> - The CSS class(es) for the button icon. Default: 'fa fa-globe'&lt;/li>
 * &lt;/ul>
 *
 * @class
 */
L.Control.TwoStepSelector = L.Control.extend({
    options: {
        id: "replaceMe",
        position: "topleft",
        title: "Select...",
        firstStepItems: [],
        firstStepItemLookup: null,
        firstStepTitle: null,
        firstStepPlaceholder: "Select one...",
        secondStepItemLookup: null,
        secondStepPlaceholder: "Select one...",
        secondStepTitle: null,
        selectionAction: null,
        firstStepValue: null, //
        iconClass: "fa fa-globe"
    },

    initialize: function (options) {
        L.setOptions(this, options)
    },

    onAdd: function (map) {
        var self = this;

        self.map = map;

        self.id = self.options.id;
        var className = "two-step-selector leaflet-bar leaflet-control";
        var container = L.DomUtil.create("div", className);
        container.id = self.options.id;

        var icon = L.DomUtil.create("button", self.options.iconClass + " leaflet-bar-part", container);
        icon.title = self.options.title;

        var selectContainer = L.DomUtil.create("div", "selectors hide", container);
        self.step1 = L.DomUtil.create("select", "selector selector-one", selectContainer);
        self.step1.title = self.options.firstStepTitle || self.options.firstStepPlaceholder;
        if (self.options.firstStepPlaceholder) {
            var step1Placeholder = L.DomUtil.create("option", "", self.step1);
            step1Placeholder.value = null;
            step1Placeholder.innerHTML = self.options.firstStepPlaceholder;
        }

        if (self.options.firstStepItems) {
            self.options.firstStepItems.forEach(function (item) {
                var option = L.DomUtil.create("option", "", self.step1);
                option.value = item.key;
                option.innerHTML = item.value;
            });
        }

        self.step2 = L.DomUtil.create("select", "selector selector-two", selectContainer);
        self.step2.disabled = true;
        self.step2.title = self.options.secondStepTitle || self.options.secondStepPlaceholder;
        if (self.options.secondStepPlaceholder) {
            var step2Placeholder = L.DomUtil.create("option", "", self.step2);
            step2Placeholder.value = null;
            step2Placeholder.innerHTML = self.options.secondStepPlaceholder;
        }

        L.DomEvent.addListener(icon, 'click', function () {
            $("#" + self.id + " .selectors").toggleClass("hide inline-block")
        });


        L.DomEvent.addListener(self.step1, "change", function () {
            self.step1Changed(self)
        }, self);
        L.DomEvent.addListener(self.step2, "change", function () {
            self.step2Changed(self)
        }, self);

        L.DomEvent.disableClickPropagation(container);

        return container;
    },

    step1Changed: function (self) {
        var step1Selection = $("#" + this.options.id + " .selector-one").val();
        $("#" + this.options.id + " .selector-two").empty();
        self.step2.disabled = true;
        if (self.options.secondStepPlaceholder) {
            var step2Placeholder = L.DomUtil.create("option", "", self.step2);
            step2Placeholder.value = null;
            step2Placeholder.innerHTML = self.options.secondStepPlaceholder;
        }
        this.options.secondStepItemLookup(step1Selection, function (keyValuePairs) {
            self.populateStep2(self, keyValuePairs)
        });
    },

    populateStep2: function (self, keyValuePairs) {
        var step2 = self.step2;

        keyValuePairs.forEach(function (item) {
            var option = L.DomUtil.create("option", "", step2);
            option.value = item.key;
            option.innerHTML = item.value;
        });

        this.step2.removeAttribute("disabled");
    },

    step2Changed: function (self) {
        var step2Selection = $("#" + self.id + " .selector-two").val();
        self.options.selectionAction(step2Selection, self.map);
        $("#" + self.id + " .selectors").toggleClass("hide inline-block")
    }
});</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="ALA.Map.html">Map</a></li><li><a href="ALA.MapConstants.html">MapConstants</a></li><li><a href="ALA.MapUtils.html">MapUtils</a></li><li><a href="L.Control.Checkbox.html">Checkbox</a></li><li><a href="L.Control.Slider.html">Slider</a></li><li><a href="L.Control.TwoStepSelector.html">TwoStepSelector</a></li><li><a href="L.TileLayer.SmartWMS.html">SmartWMS</a></li></ul><h3>Namespaces</h3><ul><li><a href="ALA.html">ALA</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.0</a> on Tue Dec 01 2015 17:09:45 GMT+1100 (AEDT)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
